<div class="templates-container">
  <!-- Header Section -->
  <div class="header-section">
    <div class="header-content">
      <div class="title-section">
        <h1 class="page-title">
          <mat-icon class="title-icon">description</mat-icon>
          Letter Templates
        </h1>
        <p class="page-subtitle">Manage and organize your letter templates</p>
      </div>
      
      <div class="header-actions">
        <button mat-raised-button 
                color="primary" 
                class="create-btn"
                (click)="createTemplate()">
          <mat-icon>add</mat-icon>
          Create Template
        </button>
      </div>
    </div>
  </div>

  <!-- Stats Section -->
  <div class="stats-section">
    <div class="stat-card">
      <div class="stat-icon">📄</div>
      <div class="stat-content">
        <div class="stat-number">{{ templates.length }}</div>
        <div class="stat-label">Total Templates</div>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon">✅</div>
      <div class="stat-content">
        <div class="stat-number">{{ activeTemplatesCount }}</div>
        <div class="stat-label">Active Templates</div>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon">🔄</div>
      <div class="stat-content">
        <div class="stat-number">{{ uploadBasedCount }}</div>
        <div class="stat-label">Upload Based</div>
      </div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon">🗄️</div>
      <div class="stat-content">
        <div class="stat-number">{{ databaseBasedCount }}</div>
        <div class="stat-label">Database Based</div>
      </div>
    </div>
  </div>

  <!-- Filters Section -->
  <div class="filters-section">
    <div class="search-filter">
      <mat-form-field appearance="outline" class="search-field">
        <mat-label>Search templates...</mat-label>
        <input matInput 
               [(ngModel)]="searchTerm" 
               placeholder="Search by name or description"
               class="search-input">
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>
    </div>
    
    <div class="type-filter">
      <mat-form-field appearance="outline" class="type-field">
        <mat-label>Filter by type</mat-label>
        <mat-select [(ngModel)]="typeFilter">
          <mat-option *ngFor="let type of templateTypes" [value]="type.value">
            {{ type.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    
    <div class="filter-actions">
      <button mat-button 
              color="warn" 
              (click)="clearFilters()"
              class="clear-btn">
        <mat-icon>clear</mat-icon>
        Clear Filters
      </button>
    </div>
  </div>

  <!-- Templates List -->
  <div class="templates-list">
    <div class="list-header">
      <h3 class="list-title">Template Library</h3>
      <span class="template-count">{{ filteredTemplates.length }} templates</span>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-state">
      <mat-spinner diameter="40"></mat-spinner>
      <p>Loading templates...</p>
    </div>

    <!-- Empty State -->
    <div *ngIf="!isLoading && filteredTemplates.length === 0" class="empty-state">
      <div class="empty-icon">📄</div>
      <h3>No templates found</h3>
      <p>Create your first template to get started</p>
      <button mat-raised-button 
              color="primary" 
              (click)="createTemplate()"
              class="empty-action-btn">
        <mat-icon>add</mat-icon>
        Create Template
      </button>
    </div>

    <!-- Templates Grid -->
    <div *ngIf="!isLoading && filteredTemplates.length > 0" class="templates-grid">
      <div *ngFor="let template of filteredTemplates" 
           class="template-card"
           [class.active]="template.isActive"
           [class.inactive]="!template.isActive">
        
        <div class="template-header">
          <div class="template-icon">
            {{ getTemplateIcon(template.letterType) }}
          </div>
          <div class="template-status">
            <div class="status-badge" [class]="template.isActive ? 'active' : 'inactive'">
              {{ template.isActive ? 'Active' : 'Inactive' }}
            </div>
          </div>
        </div>

        <div class="template-content">
          <h4 class="template-name">{{ template.name }}</h4>
          <p class="template-description">{{ template.description }}</p>
          
          <div class="template-meta">
            <div class="meta-item">
              <mat-icon class="meta-icon">category</mat-icon>
              <span class="meta-label">Type:</span>
              <span class="meta-value">{{ template.letterType | titlecase }}</span>
            </div>
            
            <div class="meta-item">
              <mat-icon class="meta-icon">storage</mat-icon>
              <span class="meta-label">Data Source:</span>
              <span class="meta-value" 
                    [class]="'data-source-' + template.dataSource.toLowerCase()">
                {{ template.dataSource }}
              </span>
            </div>
            
            <div class="meta-item">
              <mat-icon class="meta-icon">schedule</mat-icon>
              <span class="meta-label">Updated:</span>
              <span class="meta-value">{{ formatDate(template.updatedAt) }}</span>
            </div>
          </div>
        </div>

        <div class="template-actions">
          <button mat-icon-button 
                  color="primary" 
                  (click)="editTemplate(template)"
                  matTooltip="Edit template"
                  class="action-btn">
            <mat-icon>edit</mat-icon>
          </button>
          
          <button mat-icon-button 
                  [color]="template.isActive ? 'warn' : 'primary'"
                  (click)="toggleTemplateStatus(template)"
                  [matTooltip]="template.isActive ? 'Deactivate' : 'Activate'"
                  class="action-btn">
            <mat-icon>{{ template.isActive ? 'visibility_off' : 'visibility' }}</mat-icon>
          </button>
          
          <button mat-icon-button 
                  color="warn" 
                  (click)="deleteTemplate(template)"
                  matTooltip="Delete template"
                  class="action-btn">
            <mat-icon>delete</mat-icon>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
